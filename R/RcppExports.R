# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Calculate the highest-value EB Negbin loglihood ratio statistic.
#'
#' Calculate the expectation-based ZIP loglihood ratio statistic for each zone
#' and duration, but only keep the zone and duration with the highest value
#' (the MLC). The estimate of the relative risk is also calculated, along with
#' the number of iterations the EM algorithm performed.
#' @param counts matrix
#' @param baselines matrix
#' @param overdisp matrix
#' @param zones list of integer vectors
#' @param zone_lengths vector
#' @param num_locs int
#' @param num_zones int
#' @param max_dur int
#' @param store_everything boolean
#' @param score_type boolean
#' @return A data frame with five columns:
#'    \describe{
#'      \item{zone}{The top-scoring zone (spatial component of MLC).}
#'      \item{duration}{The corresponding duration (time-length of MLC).}
#'      \item{score}{The value of the loglihood ratio statistic (the scan
#'                   statistic).}
#'      \item{relrisk}{The estimated relative risk.}
#'      \item{n_iter}{The number of iterations performed by the EM algorithm.}
#'    }
#' @export
#' @keywords internal
scan_eb_negbin_cpp <- function(counts, baselines, overdisp, zones, zone_lengths, num_locs, num_zones, max_dur, store_everything, score_type) {
    .Call('scanstatistics_scan_eb_negbin_cpp', PACKAGE = 'scanstatistics', counts, baselines, overdisp, zones, zone_lengths, num_locs, num_zones, max_dur, store_everything, score_type)
}

#' Calculate the highest-value EB ZIP loglihood ratio statistic.
#'
#' Calculate the expectation-based ZIP loglihood ratio statistic for each zone
#' and duration, but only keep the zone and duration with the highest value
#' (the MLC). The estimate of the relative risk is also calculated, along with
#' the number of iterations the EM algorithm performed.
#' @param counts matrix
#' @param baselines matrix
#' @param zones list of integer vectors
#' @param zone_lengths vector
#' @param num_locs int
#' @param num_zones int
#' @param max_dur int
#' @param store_everything boolean
#' @return A data frame with five columns:
#'    \describe{
#'      \item{zone}{The top-scoring zone (spatial component of MLC).}
#'      \item{duration}{The corresponding duration (time-length of MLC).}
#'      \item{score}{The value of the loglihood ratio statistic (the scan
#'                   statistic).}
#'      \item{relrisk_in}{The estimated relative risk inside.}
#'      \item{relrisk_in}{The estimated relative risk outside.}
#'    }
#' @export
#' @keywords internal
scan_eb_poisson_cpp <- function(counts, baselines, zones, zone_lengths, num_locs, num_zones, max_dur, store_everything) {
    .Call('scanstatistics_scan_eb_poisson_cpp', PACKAGE = 'scanstatistics', counts, baselines, zones, zone_lengths, num_locs, num_zones, max_dur, store_everything)
}

#' Calculate the highest-value EB ZIP loglihood ratio statistic.
#'
#' Calculate the expectation-based ZIP loglihood ratio statistic for each zone
#' and duration, but only keep the zone and duration with the highest value
#' (the MLC). The estimate of the relative risk is also calculated, along with
#' the number of iterations the EM algorithm performed.
#' @param counts matrix
#' @param baselines matrix
#' @param probs matrix
#' @param zones list of integer vectors
#' @param zone_lengths vector
#' @param num_locs int
#' @param num_zones int
#' @param max_dur int
#' @param rel_tol double
#' @param store_everything boolean
#' @return A data frame with five columns:
#'    \describe{
#'      \item{zone}{The top-scoring zone (spatial component of MLC).}
#'      \item{duration}{The corresponding duration (time-length of MLC).}
#'      \item{score}{The value of the loglihood ratio statistic (the scan
#'                   statistic).}
#'      \item{relrisk}{The estimated relative risk.}
#'      \item{n_iter}{The number of iterations performed by the EM algorithm.}
#'    }
#' @export
#' @keywords internal
scan_eb_zip_cpp <- function(counts, baselines, probs, zones, zone_lengths, num_locs, num_zones, max_dur, rel_tol, store_everything) {
    .Call('scanstatistics_scan_eb_zip_cpp', PACKAGE = 'scanstatistics', counts, baselines, probs, zones, zone_lengths, num_locs, num_zones, max_dur, rel_tol, store_everything)
}

#' Calculate the highest-value EB ZIP loglihood ratio statistic.
#'
#' Calculate the expectation-based ZIP loglihood ratio statistic for each zone
#' and duration, but only keep the zone and duration with the highest value
#' (the MLC). The estimate of the relative risk is also calculated, along with
#' the number of iterations the EM algorithm performed.
#' @param counts matrix
#' @param baselines matrix
#' @param total_count int
#' @param zones list of integer vectors
#' @param zone_lengths vector
#' @param num_locs int
#' @param num_zones int
#' @param max_dur int
#' @param store_everything boolean
#' @return A data frame with five columns:
#'    \describe{
#'      \item{zone}{The top-scoring zone (spatial component of MLC).}
#'      \item{duration}{The corresponding duration (time-length of MLC).}
#'      \item{score}{The value of the loglihood ratio statistic (the scan
#'                   statistic).}
#'      \item{relrisk_in}{The estimated relative risk inside.}
#'      \item{relrisk_in}{The estimated relative risk outside.}
#'    }
#' @export
#' @keywords internal
scan_pb_poisson_cpp <- function(counts, baselines, total_count, zones, zone_lengths, num_locs, num_zones, max_dur, store_everything) {
    .Call('scanstatistics_scan_pb_poisson_cpp', PACKAGE = 'scanstatistics', counts, baselines, total_count, zones, zone_lengths, num_locs, num_zones, max_dur, store_everything)
}

#' Calculate the highest-value PB ZIP loglihood ratio statistic.
#'
#' Calculate the population-based ZIP loglihood ratio statistic for each zone
#' and duration, but only keep the zone and duration with the highest value
#' (the MLC). The estimate of the relative risk is also calculated, along with
#' the number of iterations the EM algorithm performed.
#' @param counts matrix
#' @param pop matrix
#' @param zones list of integer vectors
#' @param zone_lengths vector
#' @param num_locs int
#' @param num_zones int
#' @param max_dur int
#' @param rel_tol double
#' @param store_everything boolean
#' @return A data frame with five columns:
#'    \describe{
#'      \item{zone}{The top-scoring zone (spatial component of MLC).}
#'      \item{duration}{The corresponding duration (time-length of MLC).}
#'      \item{score}{The value of the loglihood ratio statistic (the scan
#'                   statistic).}
#'      \item{relrisk}{The estimated relative risk.}
#'      \item{n_iter}{The number of iterations performed by the EM algorithm.}
#'    }
#' @export
#' @keywords internal
scan_pb_zip_cpp <- function(counts, pop, zones, zone_lengths, num_locs, num_zones, max_dur, rel_tol, store_everything) {
    .Call('scanstatistics_scan_pb_zip_cpp', PACKAGE = 'scanstatistics', counts, pop, zones, zone_lengths, num_locs, num_zones, max_dur, rel_tol, store_everything)
}

#' Get indices of zero elements in a vector.
#' @param v An integer vector.
#' @return A vector with the indices of elements equal to zero in \code{v}.
#'    Indices start at zero.
#' @keywords internal
#' @export
get_zero_indices <- function(v) {
    .Call('scanstatistics_get_zero_indices', PACKAGE = 'scanstatistics', v)
}

