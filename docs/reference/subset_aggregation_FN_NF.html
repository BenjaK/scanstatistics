<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute the most likely cluster using the FN/NF Subset Aggregation algorithm. — subset_aggregation_FN_NF • scanstatistics</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">scanstatistics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/make_data.html">Process data</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction to scanstatistics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/BenjaK/scanstatistics">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the most likely cluster using the FN/NF Subset Aggregation algorithm.</h1>
    </div>

    
    <p>Compute the most likely cluster (MLC) with the Subset Aggregation method by
Neill et al. (2013), either through fast optimization over subsets of 
locations and naive optimization over subsets of streams (FN), or through
naive optimization over subsets of locations and fast optimization over 
subsets of streams (NF).</p>
    

    <pre class="usage"><span class='fu'>subset_aggregation_FN_NF</span>(<span class='no'>args</span>, <span class='kw'>score_fun</span> <span class='kw'>=</span> <span class='no'>poisson_score</span>,
  <span class='kw'>priority_fun</span> <span class='kw'>=</span> <span class='no'>poisson_priority</span>, <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='st'>"FN"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>args</th>
      <td><p>A list of arrays:</p><dl class='dl-horizontal'>
     <dt>counts</dt><dd><p>Required. An array of counts (integer or numeric). First
                   dimension is time, ordered from most recent to most 
                   distant. Second dimension indicates locations, which will 
                   be enumerated from 1 and up. Third dimension indicates 
                   data streams, which will be enumerated from 1 and up.</p></dd>
     <dt>baselines</dt><dd><p>Required. A matrix of expected counts. Dimensions are 
                      as for <code>counts</code>.</p></dd>
     <dt>penalties</dt><dd><p>Optional. A matrix of penalty terms. Dimensions are as
                      for <code>counts</code>.</p></dd>
     <dt>...</dt><dd><p>Optional. More matrices with distribution parameters.
                Dimensions are as for <code>counts</code>.</p></dd>
</dl></td>
    </tr>
    <tr>
      <th>score_fun</th>
      <td><p>A function taking matrix arguments, all of the
same dimension, and returning a matrix or vector of that dimension. 
Suitable alternatives are <code><a href='poisson_score.html'>poisson_score</a></code>, 
<code><a href='gaussian_score.html'>gaussian_score</a></code>.</p></td>
    </tr>
    <tr>
      <th>priority_fun</th>
      <td><p>A function taking matrix arguments, all of the
same dimension, and returning a matrix or vector of that dimension. 
Suitable alternatives are <code><a href='poisson_priority.html'>poisson_priority</a></code>, 
<code><a href='gaussian_priority.html'>gaussian_priority</a></code>.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>Either "FN" or "NF":</p><dl class='dl-horizontal'>
  <dt>FN</dt><dd><p>Fast optimization over subsets of locations and naive 
            optimization over subsets of streams. Can be used if the 
            number of data streams is small.</p></dd>
  <dt>NF</dt><dd><p>Fast optimization over subsets of streams and naive 
            optimization over subsets of locations. Can be used if the 
            number of locations is small.</p></dd>
</dl></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with 4 elements:</p><dl class='dl-horizontal'>
     <dt>score</dt><dd><p>A scalar; the score of the MLC.</p></dd>
     <dt>duration</dt><dd><p>An integer; the duration of the MLC, i.e. how many time 
                     periods from the present into the past the MLC 
                     stretches.</p></dd>
     <dt>locations</dt><dd><p>An integer vector; the locations contained in the MLC.</p></dd>
     <dt>streams</dt><dd><p>An integer vector; the data streams contained in the 
                    MLC.</p></dd>
  </dl>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Neill, Daniel B., Edward McFowland, and Huanian Zheng (2013). <em>Fast 
   subset scan for multivariate event detection</em>. Statistics in Medicine 
   32 (13), pp. 2185-2208.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Benjamin Allévius.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
